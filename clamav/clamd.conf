# clamd.conf - ClamAV daemon configuration
# Mounted into the container to override defaults

# Required: log to stdout for Docker
Foreground yes
LogTime yes

# TCP socket for clamd communication
TCPSocket 3310
TCPAddr 0.0.0.0

# ── Size limits for Docker image tarballs ──────────────────────────────────
# Docker images can easily exceed 500MB — set generous limits
StreamMaxLength 4000M
MaxFileSize 2000M
MaxScanSize 4000M

# Archive scanning settings
MaxRecursion 16
MaxFiles 10000
MaxEmbeddedPE 40M
MaxHTMLNormalize 40M
MaxScriptNormalize 20M
MaxZipTypeRcg 1M

# Scan settings
ScanArchive yes
ScanELF yes
ScanPE yes
ArchiveBlockEncrypted no

# Database directory (must match the volume mount)
DatabaseDirectory /var/lib/clamav